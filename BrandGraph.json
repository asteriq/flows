[{"id":"4efc0940.fe093167","type":"create","z":"041be952.7839884e","name":"Query Playbook","host":"https://vora-playbooks-tdx26.app.quantiply.com","notebookName":"Vora TimeSeries","x":519,"y":179,"edges":[["a5fd66ef.337add42"]]},{"id":"abc0e128.85a68ec8","type":"sh","z":"041be952.7839884e","name":"Get Data and Load into HDFS","content":"wget https://quantiply.com/brandgraphv3.jsg\nhadoop fs -put brandgraphv3.jsg\nhadoop fs -ls","x":226,"y":207,"edges":[["c422df0a.36c79759"]]},{"id":"d7e061ab.c426ac62","type":"inject","z":"041be952.7839884e","name":"Ask me!","topic":"","message":"","messageType":"date","repeat":"","crontab":"","once":false,"x":457,"y":52,"edges":[["4efc0940.fe093167"]]},{"id":"c422df0a.36c79759","type":"spark","z":"041be952.7839884e","name":"Create Partitions and Series Tables","content":"import org.apache.spark.sql._\nval sqlContext = new SapSQLContext( sc )\n\nsqlContext.sql(s\"\"\"REGISTER ALL TABLES USING com.sap.spark.vora OPTIONS (eagerLoad \"false\")\"\"\")\n\nsqlContext.sql(\"SHOW TABLES\").show()\nsqlContext.sql(\"CREATE PARTITION FUNCTION PF5(X BIGINT) AS BLOCK(X) PARTITIONS 16 BLOCKSIZE 1000 USING com.sap.spark.engines\")\nsqlContext.sql(\"CREATE PARTITION SCHEME PS5 USING PF5 USING com.sap.spark.engines\")\nsqlContext.sql(\"\"\"CREATE GRAPH BRANDGRAPH PARTITION BY PS5(NODEID)\n     USING com.sap.spark.engines\n     OPTIONS (\n     files \"/user/spark/brandgraphv3.jsg\",\n     storagebackend \"hdfs\")\"\"\".stripMargin)","x":245,"y":271,"edges":[["a5fd66ef.337add42"]]},{"id":"5a2f6dd1.08a36a26","type":"create","z":"041be952.7839884e","name":"Create Vora Playbook","host":"https://vora-playbooks-tdx26.app.quantiply.com","notebookName":"Vora Graph Model","x":201,"y":148,"edges":[["abc0e128.85a68ec8"]]},{"id":"125331cb.664ac5cc","type":"inject","z":"041be952.7839884e","name":"Setup","topic":"","message":"","messageType":"date","repeat":"","crontab":"","once":false,"x":166,"y":96,"edges":[["5a2f6dd1.08a36a26"]]},{"id":"a5fd66ef.337add42","type":"spark","z":"041be952.7839884e","name":"Find All Products","content":"sqlContext.sql(\"``SELECT A.DESCRIPTION FROM PRODUCT A USING GRAPH BRANDGRAPH`` USING com.sap.spark.engines\").show()","x":524,"y":245,"edges":[["086fdf73.af76537d","d362e201.0cf1c23b"]]},{"id":"086fdf73.af76537d","type":"table","z":"041be952.7839884e","name":"Get Product List","sequenceNum":1,"pulseType":"widget-table","description":"","enabled":true,"streamEnabled":false,"maxPoints":10,"x":522,"y":326,"edges":[[]]},{"id":"d362e201.0cf1c23b","type":"spark","z":"041be952.7839884e","name":"Compute Degree for BrandGraph","content":"sqlContext.sql(\"``SELECT DEGREE(A) FROM CUSTOMER A USING GRAPH BRANDGRAPH`` USING com.sap.spark.engines\").show()","x":843,"y":135,"edges":[["1dc7a503.2681ed18"]]},{"id":"1dc7a503.2681ed18","type":"spark","z":"041be952.7839884e","name":"Traverse Brandgraph","content":"sqlContext.sql(\"``SELECT A.BASKET_SIZE, A.CUSTOMER_LTV, A.BUYS.DESCRIPTION, A.BUYS.OWNEDBY.NAME FROM CUSTOMER A USING GRAPH BRANDGRAPH`` USING com.sap.spark.engines\").show()","x":806,"y":203,"edges":[["1e1029d0.2671fd98"]]},{"id":"1e1029d0.2671fd98","type":"spark","z":"041be952.7839884e","name":"Customer Graph","content":"sqlContext.sql(\"``SELECT NODEID, NODETYPE, BASKET_SIZE, CUSTOMER_LTV FROM ANY USING GRAPH BRANDGRAPH`` USING com.sap.spark.engines\").show()","x":792,"y":264,"edges":[["ecb433dd.99598b52"]]},{"id":"ecb433dd.99598b52","type":"spark","z":"041be952.7839884e","name":"Connected Components","content":"sqlContext.sql(\"``SELECT A.BASKET_SIZE, CONNECTED_COMPONENT(STRONG A) AS SCC, CONNECTED_COMPONENT(WEAK a) AS WCC FROM CUSTOMER A USING GRAPH BRANDGRAPH`` USING com.sap.spark.engines\").show()","x":813,"y":321,"edges":[["1fd4cff1.8ef3370c","478440b6.8854e648"]]},{"id":"1fd4cff1.8ef3370c","type":"table","z":"041be952.7839884e","name":"Show Connected Components","sequenceNum":1,"pulseType":"widget-table","description":"","enabled":true,"streamEnabled":false,"maxPoints":10,"x":619,"y":389,"edges":[[]]},{"id":"e639368f.c4004321","type":"EKG","z":"041be952.7839884e","name":"Customer Brand Affinity Analysis","sequenceNum":1,"pulseType":"widget-ekg","description":"","enabled":true,"streamEnabled":false,"maxPoints":10,"x":893,"y":449,"edges":[[]]},{"id":"478440b6.8854e648","type":"function","z":"041be952.7839884e","name":"Graph Model Generator","clusterid":"","func":"\nvar options = {\n      nodes: {\n        shape: 'circle',\n         scaling: {\n            customScalingFunction: function (min,max,total,value) {\n              return value/total;\n            },\n            min:5,\n            max:150\n          },\n        font: {\n          size: 12,\n          face: 'Tahoma'\n        }\n      },\n      edges: {\n        width: 0.15,\n        color: {inherit: 'from'},\n        smooth: {\n          type: 'continuous'\n        }\n      },\n      physics: {\n        stabilization: false,\n        barnesHut: {\n          gravitationalConstant: -80000,\n          springConstant: 0.001,\n          springLength: 200\n        }\n      },\n      interaction: {\n        tooltipDelay: 200,\n        hideEdgesOnDrag: true\n      }\n    };\n\ndataframe.message = {\n    dataUrl: 'https://quantiply.com/tdx/genome-data.json',\n    options: options\n};\n   \nreturn dataframe;\n","outputs":1,"noerr":0,"userComments":[],"x":863,"y":380,"edges":[["e639368f.c4004321"]]}]
